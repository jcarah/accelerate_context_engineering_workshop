{
    "state_variable_fidelity": {
        "metric_type": "llm",
        "agents": [
            "retail_location_strategy"
        ],
        "dataset_mapping": {
            "user_request": {
                "source_column": "user_inputs"
            },
            "final_state": {
                "source_column": "extracted_data:state_variables"
            }
        },
        "template": "You are evaluating the state management fidelity of a Retail Location Strategy AI Agent.\n\n**User Request:**\n{user_request}\n\n**Final Agent State:**\n{final_state}\n\n**Evaluation Criteria:**\n1.  **Alignment:** Does the 'parsed_request' and 'target_location'/'business_type' in the final state accurately match the User Request?\n2.  **Completeness:** Are key fields like 'market_research_findings', 'competitor_analysis', and 'gap_analysis' populated with relevant data?\n3.  **Consistency:** Is the state consistent across different stages (e.g., does the market research focus on the correct location)?\n\n**Scoring Rubric (1-5):**\n- 5: Perfect alignment. All state variables are populated with highly relevant and consistent data matching the user request.\n- 4: Strong alignment. Minor inconsistencies or slightly generic data in one field, but core intent is preserved.\n- 3: Moderate alignment. The location or business type might be correct, but significant fields are missing or the analysis is too generic.\n- 2: Poor alignment. State variables contradict the user request (e.g., wrong city) or are largely empty.\n- 1: Complete failure. State variables are empty, hallucinated, or completely unrelated to the request.\n\n**Response Format:**\nScore: [1-5]\nExplanation: [Reasoning]"
    },
    "market_research_depth": {
        "metric_type": "llm",
        "agents": [
            "retail_location_strategy"
        ],
        "dataset_mapping": {
            "market_research": {
                "source_column": "extracted_data:market_research_findings"
            },
            "competitor_analysis": {
                "source_column": "extracted_data:competitor_analysis"
            }
        },
        "template": "You are evaluating the depth and quality of market research performed by an AI Agent.\n\n**Market Research Findings:**\n{market_research}\n\n**Competitor Analysis:**\n{competitor_analysis}\n\n**Evaluation Criteria:**\n1.  **Depth:** Does the research cover demographics, economic trends, and specific location characteristics?\n2.  **Specificity:** Does the competitor analysis identify specific real-world competitors (by name) and analyze their strengths/weaknesses (e.g., star ratings, review counts)?\n3.  **Relevance:** Is the data relevant to the specific business type and location inferred from the context?\n4.  **Synthesis:** Does the agent synthesize the data into meaningful insights rather than just listing facts?\n\n**Scoring Rubric (1-5):**\n- 5: Exceptional depth. Comprehensive demographics, specific competitor list with quantitative data (ratings/reviews), and insightful synthesis.\n- 4: Good depth. Covers most bases, identifies real competitors, but analysis might be slightly superficial.\n- 3: Adequate. Generic demographics, lists some competitors but lacks detailed analysis or quantitative metrics.\n- 2: Weak. Very generic info (e.g., \"It's a busy city\"), few or no specific competitors named.\n- 1: Poor. Empty, irrelevant, or hallucinates non-existent data.\n\n**Response Format:**\nScore: [1-5]\nExplanation: [Reasoning]"
    },
    "strategic_recommendation_quality": {
        "metric_type": "llm",
        "agents": [
            "retail_location_strategy"
        ],
        "dataset_mapping": {
            "strategic_report": {
                "source_column": "extracted_data:strategic_report"
            }
        },
        "template": "You are a senior business consultant evaluating a strategic location recommendation generated by an AI.\n\n**Strategic Report:**\n{strategic_report}\n\n**Evaluation Criteria:**\n1.  **Clarity:** Is the 'top_recommendation' clearly identified with a specific location/zone?\n2.  **Evidence-Based:** Is the recommendation supported by cited evidence (e.g., 'saturation_index', 'demand_signal', competitor density)?\n3.  **Risk Assessment:** Does the report acknowledge risks ('concerns') and propose mitigation strategies?\n4.  **Actionability:** Are the 'next_steps' concrete and actionable for a business owner?\n\n**Scoring Rubric (1-5):**\n- 5: Strategic Mastery. Clear, data-driven recommendation with specific metrics (scores), nuanced risk assessment, and highly actionable steps.\n- 4: Strong Strategy. Good recommendation with some supporting data, but risk assessment or next steps could be more specific.\n- 3: Average. Makes a recommendation but lacks strong quantitative backing or specific mitigation strategies.\n- 2: Weak. Recommendation is vague or generic. Lacks evidence or logic.\n- 1: Failure. No recommendation or nonsensical output.\n\n**Response Format:**\nScore: [1-5]\nExplanation: [Reasoning]"
    },
    "tool_usage_effectiveness": {
        "metric_type": "llm",
        "agents": [
            "retail_location_strategy"
        ],
        "dataset_mapping": {
            "tool_interactions": {
                "source_column": "tool_interactions"
            },
            "user_request": {
                "source_column": "user_inputs"
            }
        },
        "template": "Evaluate the effectiveness of the AI agent's tool usage given the user's request.\n\n**User Request:**\n{user_request}\n\n**Tool Interactions:**\n{tool_interactions}\n\n**Evaluation Criteria:**\n1.  **Relevance:** Did the agent use the 'search_places' tool with queries relevant to the user's request (correct business type and location)?\n2.  **Coverage:** Did it perform enough searches to get a good picture (e.g., searching for both direct and indirect competitors)?\n3.  **Completeness:** Did it successfully call the output generation tools ('generate_html_report', 'generate_infographic') at the end?\n4.  **Efficiency:** Did it avoid unnecessary or redundant tool calls?\n\n**Scoring Rubric (1-5):**\n- 5: Optimal usage. Highly relevant search queries, comprehensive coverage, and successful report generation.\n- 4: Good usage. Relevant searches and report generation, but queries could be slightly more optimized.\n- 3: Adequate. Used tools but queries were generic or report generation was missing/failed.\n- 2: Poor. Irrelevant searches or failed to use key tools.\n- 1: Failure. No tool usage or complete failure to address the request.\n\n**Response Format:**\nScore: [1-5]\nExplanation: [Reasoning]"
    },
    "token_usage": {
        "metric_type": "deterministic",
        "agents": [
            "retail_location_strategy"
        ]
    },
    "latency_metrics": {
        "metric_type": "deterministic",
        "agents": [
            "retail_location_strategy"
        ]
    }
}